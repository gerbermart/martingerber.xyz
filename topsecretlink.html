<!DOCTYPE html>
<html>
<head>
  <title>Mint Button</title>
</head>
<body>
  <button onclick="freeMint()">Free Mint (Allowlist Only)</button>
  <button onclick="mintAlbum()">Mint Album (0.01 ETH)</button>

  <script>
    const ethereumProvider = window.ethereum;
    ethereumProvider.chainId = '0x5'; // Goerli chain ID

    async function estimateGasLimit(transactionParameters) {
      try {
        const gasLimit = await ethereumProvider.request({ method: 'eth_estimateGas', params: [transactionParameters] });
        return gasLimit;
      } catch (error) {
        console.error('Error estimating gas limit:', error);
        throw error;
      }
    }

    async function sendTransaction(transactionParameters) {
      try {
        const result = await ethereumProvider.request({ method: 'eth_sendTransaction', params: [transactionParameters] });
        console.log('Transaction result:', result);
      } catch (error) {
        console.error('Error sending transaction:', error);
        throw error;
      }
    }

    async function freeMint() {
      try {
        // Request access to the user's Ethereum accounts
        await ethereumProvider.request({ method: 'eth_requestAccounts' });

        const contractAddress = '0x094b269f0b5bd4436939c3ab1a0056024d10b689'; // Replace with your contract address on the Goerli chain

        const tokenNum = 1; // Replace with the desired token number
        const mintCount = 1; // Replace with the desired mint count

        const tokenNumHex = '0x' + tokenNum.toString(16);
        const mintCountHex = '0x' + mintCount.toString(16);

        const functionSelector = '0x91c09d52'; // Function selector for 'freeMint(uint256,uint256)'
        const data = functionSelector + tokenNumHex.slice(2).padStart(64, '0') + mintCountHex.slice(2).padStart(64, '0');

        const transactionParameters = {
          from: ethereumProvider.selectedAddress,
          to: contractAddress,
          data: data
        };

        // Estimate the gas limit
        const gasLimit = await estimateGasLimit(transactionParameters);

        // Add the gas limit to the transaction parameters
        transactionParameters.gas = gasLimit;

        // Send the transaction
        await sendTransaction(transactionParameters);
      } catch (error) {
        console.error('Error:', error);
      }
    }

    async function mintAlbum() {
      try {
        // Request access to the user's Ethereum accounts
        await ethereumProvider.request({ method: 'eth_requestAccounts' });

        const contractAddress = '0x094b269f0b5bd4436939c3ab1a0056024d10b689'; // Replace with your contract address on the Goerli chain

        const tokenNum = 1; // Replace with the desired token number
        const mintCount = 1; // Replace with the desired mint count

        const tokenNumHex = '0x' + tokenNum.toString(16);
        const mintCountHex = '0x' + mintCount.toString(16);

        const functionSelector = '0x4cb16ced'; // Function selector for 'mintAlbum(uint256,uint256)'
        const data = functionSelector + tokenNumHex.slice(2).padStart(64, '0') + mintCountHex.slice(2).padStart(64, '0');

        const value = '10000000000000000'; // 0.01 ether in wei

        const transactionParameters = {
          from: ethereumProvider.selectedAddress,
          to: contractAddress,
          data: data,
          value: value
        };

        // Estimate the gas limit
        const gasLimit = await estimateGasLimit(transactionParameters);

        // Add the gas limit to the transaction parameters
        transactionParameters.gas = gasLimit;

        // Send the transaction
        await sendTransaction(transactionParameters);
      } catch (error) {
        console.error('Error:', error);
      }
    }
  </script>
</body>
</html>
