<!DOCTYPE html>
<html>
<head>
    <title>Mint Album</title>
    <script>
        const contractAddress = '0xbb1696ed7CE36a50a947e20F3785DE11460AEcEe'; // Replace with the actual contract address
        const contractABI = [
            [
                {
                    "anonymous": false,
                    "inputs": [
                        {
                            "indexed": true,
                            "internalType": "address",
                            "name": "addr",
                            "type": "address"
                        }
                    ],
                    "name": "AddressAllowed",
                    "type": "event"
                },
                {
                    "anonymous": false,
                    "inputs": [
                        {
                            "indexed": true,
                            "internalType": "address",
                            "name": "operator",
                            "type": "address"
                        },
                        {
                            "indexed": true,
                            "internalType": "address",
                            "name": "from",
                            "type": "address"
                        },
                        {
                            "indexed": true,
                            "internalType": "address",
                            "name": "to",
                            "type": "address"
                        },
                        {
                            "indexed": false,
                            "internalType": "uint256",
                            "name": "id",
                            "type": "uint256"
                        },
                        {
                            "indexed": false,
                            "internalType": "uint256",
                            "name": "value",
                            "type": "uint256"
                        }
                    ],
                    "name": "TransferSingle",
                    "type": "event"
                },
                {
                    "anonymous": false,
                    "inputs": [
                        {
                            "indexed": false,
                            "internalType": "string",
                            "name": "value",
                            "type": "string"
                        },
                        {
                            "indexed": true,
                            "internalType": "uint256",
                            "name": "id",
                            "type": "uint256"
                        }
                    ],
                    "name": "URI",
                    "type": "event"
                },
                {
                    "inputs": [
                        {
                            "internalType": "uint256",
                            "name": "tokenId",
                            "type": "uint256"
                        },
                        {
                            "internalType": "uint256",
                            "name": "mintCount",
                            "type": "uint256"
                        }
                    ],
                    "name": "freeMint",
                    "outputs": [],
                    "stateMutability": "nonpayable",
                    "type": "function"
                },
                {
                    "inputs": [
                        {
                            "internalType": "uint256",
                            "name": "tokenId",
                            "type": "uint256"
                        },
                        {
                            "internalType": "uint256",
                            "name": "mintCount",
                            "type": "uint256"
                        }
                    ],
                    "name": "mintAlbum",
                    "outputs": [],
                    "stateMutability": "payable",
                    "type": "function"
                },
                {
                    "inputs": [
                        {
                            "internalType": "string",
                            "name": "uri_input",
                            "type": "string"
                        }
                    ],
                    "name": "mintNewToken",
                    "outputs": [],
                    "stateMutability": "payable",
                    "type": "function"
                },
                {
                    "inputs": [
                        {
                            "internalType": "address",
                            "name": "addressInput",
                            "type": "address"
                        }
                    ],
                    "name": "setAllow",
                    "outputs": [],
                    "stateMutability": "nonpayable",
                    "type": "function"
                },
                {
                    "inputs": [
                        {
                            "internalType": "uint256",
                            "name": "newMintPrice",
                            "type": "uint256"
                        }
                    ],
                    "name": "setMintPrice",
                    "outputs": [],
                    "stateMutability": "nonpayable",
                    "type": "function"
                },
                {
                    "inputs": [
                        {
                            "internalType": "uint256",
                            "name": "tokenId",
                            "type": "uint256"
                        },
                        {
                            "internalType": "address",
                            "name": "addressInput",
                            "type": "address"
                        }
                    ],
                    "name": "setPayout",
                    "outputs": [],
                    "stateMutability": "nonpayable",
                    "type": "function"
                },
                {
                    "inputs": [
                        {
                            "internalType": "uint256",
                            "name": "tokenId",
                            "type": "uint256"
                        },
                        {
                            "internalType": "string",
                            "name": "uriInput",
                            "type": "string"
                        }
                    ],
                    "name": "setTokenUri",
                    "outputs": [],
                    "stateMutability": "nonpayable",
                    "type": "function"
                },
                {
                    "inputs": [
                        {
                            "internalType": "uint256",
                            "name": "tokenId",
                            "type": "uint256"
                        },
                        {
                            "internalType": "string",
                            "name": "uriInput",
                            "type": "string"
                        }
                    ],
                    "name": "setURI",
                    "outputs": [],
                    "stateMutability": "nonpayable",
                    "type": "function"
                },
                {
                    "inputs": [],
                    "stateMutability": "nonpayable",
                    "type": "constructor"
                },
                {
                    "inputs": [
                        {
                            "internalType": "uint256",
                            "name": "",
                            "type": "uint256"
                        }
                    ],
                    "name": "addresses",
                    "outputs": [
                        {
                            "internalType": "address",
                            "name": "",
                            "type": "address"
                        }
                    ],
                    "stateMutability": "view",
                    "type": "function"
                },
                {
                    "inputs": [],
                    "name": "ALBUM_ID",
                    "outputs": [
                        {
                            "internalType": "uint256",
                            "name": "",
                            "type": "uint256"
                        }
                    ],
                    "stateMutability": "view",
                    "type": "function"
                },
                {
                    "inputs": [
                        {
                            "internalType": "uint256",
                            "name": "",
                            "type": "uint256"
                        }
                    ],
                    "name": "allow_addresses",
                    "outputs": [
                        {
                            "internalType": "address",
                            "name": "",
                            "type": "address"
                        }
                    ],
                    "stateMutability": "view",
                    "type": "function"
                },
                {
                    "inputs": [
                        {
                            "internalType": "uint256",
                            "name": "",
                            "type": "uint256"
                        }
                    ],
                    "name": "allowed_addresses",
                    "outputs": [
                        {
                            "internalType": "address",
                            "name": "",
                            "type": "address"
                        }
                    ],
                    "stateMutability": "view",
                    "type": "function"
                },
                {
                    "inputs": [],
                    "name": "mintPrice",
                    "outputs": [
                        {
                            "internalType": "uint256",
                            "name": "",
                            "type": "uint256"
                        }
                    ],
                    "stateMutability": "view",
                    "type": "function"
                },
                {
                    "inputs": [],
                    "name": "owner",
                    "outputs": [
                        {
                            "internalType": "address",
                            "name": "",
                            "type": "address"
                        }
                    ],
                    "stateMutability": "view",
                    "type": "function"
                },
                {
                    "inputs": [],
                    "name": "totalMints",
                    "outputs": [
                        {
                            "internalType": "uint256",
                            "name": "",
                            "type": "uint256"
                        }
                    ],
                    "stateMutability": "view",
                    "type": "function"
                },
                {
                    "inputs": [
                        {
                            "internalType": "uint256",
                            "name": "tokenId",
                            "type": "uint256"
                        }
                    ],
                    "name": "uri",
                    "outputs": [
                        {
                            "internalType": "string",
                            "name": "",
                            "type": "string"
                        }
                    ],
                    "stateMutability": "view",
                    "type": "function"
                }
            ]
        ];

        async function mintAlbum() {
            try {
                const provider = window.ethereum;

                const contract = new window.ethereum.Contract(contractABI, contractAddress);

                const mintCount = 1; // Number of album mints

                const mintPrice = await contract.methods.mintPrice().call();
                const totalAmount = mintPrice * mintCount;

                const accounts = await provider.request({ method: 'eth_requestAccounts' });
                const from = accounts[0];

                const options = {
                    from,
                    value: totalAmount
                };

                await contract.methods.mintAlbum(1, mintCount).send(options);

                console.log('Mint transaction sent successfully!');
                alert('MINT COMPLETE!');
            } catch (error) {
                console.error('Error occurred while minting:', error);
                alert('Error occurred while minting: ' + error.message);
            }
        }

        async function freeMint() {
            try {
                const provider = window.ethereum;

                const contract = new window.ethereum.Contract(contractABI, contractAddress);

                const mintCount = 1; // Number of album mints

                const accounts = await provider.request({ method: 'eth_requestAccounts' });
                const from = accounts[0];

                const isAllowed = await contract.methods.isAddressAllowed(from).call();

                if (!isAllowed) {
                    throw new Error('Address is not allowed to perform a free mint');
                }

                const options = {
                    from
                };

                await contract.methods.freeMint(1, mintCount).send(options);

                console.log('Free Mint transaction sent successfully!');
                alert('MINT COMPLETE!');
            } catch (error) {
                console.error('Error occurred while free minting:', error);
                alert('Error occurred while free minting: ' + error.message);
            }
        }
    </script>
</head>
<body>
    <button onclick="mintAlbum()">Mint Album</button>
    <button onclick="freeMint()">Free Mint</button>
</body>
</html>
