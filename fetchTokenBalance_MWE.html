<!DOCTYPE html>
<html>
<head>
  <title>Token Balance</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
</head>
<body>
  <h1>Token Balance</h1>
  <div id="balance"></div>

  <script>
    async function fetchTokenBalance(contractAddress, tokenId) {
      try {
        const response = await fetch('https://api.github.com/repos/gerbermart/martingerber.xyz/actions/secrets/OPENSEA_API_KEY', {
          headers: {
            Authorization: 'Bearer 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',
            Accept: 'application/vnd.github.v3+json'
          }
        });

        if (response.ok) {
          const data = await response.json();
          const apiKey = data.secret;

          // Use the apiKey to make the API request
          const apiUrl = `https://api.opensea.io/api/v1/asset/${contractAddress}/${tokenId}/`;

          try {
            const tokenResponse = await fetch(apiUrl, {
              headers: {
                'X-API-KEY': apiKey
              }
            });

            if (tokenResponse.ok) {
              const tokenData = await tokenResponse.json();
              const balance = tokenData.balance;

              // Display the token balance
              $('#balance').text(`Token Balance: ${balance}`);
            } else {
              throw new Error('Error fetching token balance: ' + tokenResponse.statusText);
            }
          } catch (error) {
            console.error('Error fetching token balance:', error);
          }
        } else {
          throw new Error('Error retrieving GitHub secret: ' + response.statusText);
        }
      } catch (error) {
        console.error('Error retrieving GitHub secret:', error);
      }
    }

    // Usage: Call the function with contract address and token ID
    fetchTokenBalance('0xd8fabd716eccbf98157f6728d3c187625a513127', '6');
  </script>
</body>
</html>
